# 스프레드시트 환경

- 액셀 고급탭

Enter키를 누른후 다음셀로 이동할 방향 결정할 수 있음

소수점 자동 삽입 : 500입력시 소수점 위치가 2라면 결과는 5가됨.

셀 내용 자동완성은 숫자나 날짜 내용에는 적용안됨.

계산 결과 대신 수식을 셀에 표시할 수 있음

페이지 나누기 표시 인쇄 안눌러도 나오게끔 할 수 있다.

한 셀당 눈금선도 고급 탭에서 조절할 수 있다.

- 기출

3,2,4,3,2,2,4,4,4,4,3,3,2

O,O,O,O,X,O,O,O,O,O,O,O,O

- 배운점

창나누기는 수직, 수평,

틀고정은 인쇄에는 영향을 주지 않는다.

각 시트당 확대 축소 비율은 다르게 적용된다.

틀고정, 창나누기는 하나만 할 수 있다.

### 통합 문서 관리

F12 눌러도 문서 저장가능

xml,mht,mhtml,htm,html,xlt,xltx,xltm,prn,dif,slk,xla,xlam,pdf,xps,ods등으로 저장가능

저장할때, 비밀번호도 열기, 쓰기 비밀번호 지정할수 있구나.

열기번호는 최대 255, 

쓰기암호는 최대 15자

- 작업 영역 저장

엑셀에 없음, 우선에 xlw로 나중에 복구할 수 있도록 모든 창의 현재 레이아웃을 저장한다고 한다.

- 시트보호, 통합문서보호도 가능하다.

4,2,4,2,2,4

X,O,O,X,X,X

- 배운점

암호는 대소문자를 구별한다.

통합 문서보호를 설정해도 차트, 도형등의 그래픽 개체를 변경할 수 있다.

사용자별로 공유된 통합문서를 열기위한 암호는 1개이다.

공유 통합 문서에서 특정 사용자의 연결을 끊을 수는 있다.

### 데이터 입력

문자는 왼쪽 정렬이다. 숫자 오른쪽(지수형식도 오른쪽)

혼합시 문자열으로 인식

분수의 경우 대분수를 입력한 후 공백을 입력하여 표현함.

날짜 데이터는 - , /

시간데이터는 ‘:’ 콜론

Ctrl + ; → 현재 시스템 날짜 입력

Ctrl + Shift + ; → 현재 시스템 시간 입력

- 글꼴 탭에서 윗주 다룰수 있다.

- 기출테스트

3,4,3,2,4,2,4,1,

O,O,O,O,O,O,O,O

- 배운점

메모도 셀 옮기면 같이 따라 움직인다.

엑셀에서는 Shift + Enter가 아니라, Alt + Enter를 눌러야 한셀에서 줄이 바뀐다.

수식 보려면 Ctrl + ~이다. Alt와 헷갈리지 말자.

Ctrl + End → 내가 무언가 썻던 대각선 열까지 한방에 가줌

Ctrl + H → 바꾸기로 바로 갈 수 있음.

데이터 전체 긁지말고 Ctrl + Shift + 8로 한방에 긁을 수 있다.

Shift + Space → 한 행 전체 선택

Ctrl + Space → 한 열 전체 선택

- 날짜/시간 데이터

1-홍길동-01을 채우기 핸들을 쓰면 오른쪽 숫자만 증가한다.

- 연속 데이터 채우기

파일 - 옵션 - 고급에서 ‘일반’ 항목의 [사용자 지정 목록 편집]에서 추가하면 연속 데이터를 내가 마음대로 만들 수도 있다.

홈 - 편집 -채우기 - 계열을 선택하면, 급수, 날짜를 연, 월,일 단위로 자동 채우기를 할 수 있따.

행/열너비 0 으로 해도 행/열 숨길수 있다.

시트 이름 최대 31자

Shift+F11 워크시트 바로 만들기

- 기출문제

2,2,2,1,2,2,2,2

O,O,X,O,O,O,O,X

- 배운점

소수점은 채우기 필터 안된다. 정수단위로 증가한다.

### 서식 설정

Ctrl+1로 셀서식 바로 킬수 있음.

- 사용자 지정 서식 코드

서식코드는 [양수, 음수, 0값, 텍스트] 4개를 ; 로 구분하여 작성

조건이나 글꼴 색 등은 [ ] 대괄호 써서 입력

ex) #,##0; [빨강](#,##0); 0.00; @”님”

##% : 32456 → 3246% 100을 곱한후 %를 붙임

## →  유효한 자리수만 표시, 유효하지 않은 0은 표시X

“?” → ex)?.?? : 32.456 → 32.46 유효하지 않은 0 대신 공백

조건 → ex)[>300]#,##0 : 324.5 → 325

@ → ex) @교육 → 시대교육

* → ex) @*! → 시대!!!!!!!!

아래밑줄_ → 입력된 숫자ㅇ데이터의 오른쪽 끝에 하나의 공백을 추가 ex) #,##0”원_- : 32,456 → 32원 (원 다음에 공백이 하나 있음)

mmm → Jan ~ Dec

mmmm → January ~ December

ddd → Sun ~ Sat

dddd → Sunday ~ Saturday

aaa → 월 ~ 일

aaaa → 월요일 ~ 일요일

- 조건부 서식

지정한 규칙을 만족할 경우 데이터의 행 전체에 대하여 서식을 지정ㅎ하고자 할 때는 규칙 지정시 열 이름에 ‘$’를 붙여야한다.

- 기출

1,?,2,3,2

O,X,X,X,X

- 배운점

일반 서식은 없다.

조건부 서식은 기존의 셀 서식에 우선하여 적용됨.

2개의 규칙은 안되고, 1개의 규칙만 설정가능 물론 AND로 엮을수는 있음

셀 서식에서 맨앞에 붙은 0은 생략된다.

0.25 → 0#.#% → 25.%

0.57 → #.# → .6

90.86 → #,##0.0 → 90.9 ( 0은 0을 나타내는게 아니라 한자리를 의미하고 없으면 0을 넣겠다는 의미이다. )

100 → #,###;@”점” → 100 (양수, 음수 0, 텍스트 순서이다.)

ex) 기본값 : 33:25:00

h:mm → 9 : 25

hh:mm → 09 : 25

[h]:mm → 33 : 25

### 기본 계산식

수식을 상수로 변경하려면 수식작성줄에서 F9를 누르고 Enter를 누르면 상수로 바뀐다. ex) =SUM(3,5) → 8

- 워크시트 간 셀 참조

A1 + ‘매출 현황’!A1 → 워크시트 이름에 공백이 있는 경우 ‘ ‘로 워크시트 이름을 묶는다.

- 통합 문서 간 셀 참조

다른 통합 문서간 셀 참조도 가능하다.

A1+[매출현황표.xlsx]Sheet2!A1

띄어 쓰기가 있으면 ‘ ‘로 묶는다.

ex)

=A1+’[매출현황표.xlsx]매출 현황’!A1

=A1+’[매출 현황표.xlsx]매출현황’!A1

- 3차원 참조

=SUM(Sheet1: Sheet3!A1) → Sheet1부터 Sheet3까지의 [A1] 셀을 모두 더하라는 식

사용할 수 있는 함수로는 SUM, AVERAGE, COUNTA,STDEV등이 있다.

배열 수식에는 3차원 참조를 사용할 수 없다.

첫문자는 반드시 ‘_’ , ‘\’, ‘문자’ 중 하나로 시작해야 한다.

특수문자를 포함할 수 없다.

최대 255자 까지 대소문자 구분 X

셀주소와 같은 이름은 사용 X

첫행의 항목이름에 공백이 포함되어 있을 경우 공백은 ‘_’로 채워짐

 → 

| 오류메시지 | 내용 |
| --- | --- |
| #DIV/0! | 값이 포함되지 않은 셀이나 0으로 숫자를 나눈 경우 발생 |
| #NAME? | 인식할 수 없는 문자열을 수식에 사용했을 경우
함수 이름이나 정의되지 않은 셀 이름을 사용했을 경우 |
| #NULL! | 교차하지 않은 두 영역의 교차점을 참조 영역으로 지정하였을 경우 발생 |
| #NUM! | 수식이나 함수에 잘못된 숫자 값이나 표시할 수 있는 숫자 값의 범위를 벗어 났을 경우 발생 |
| #N/A | 함수나 수식에 사용할 수 없는 값을 지정했을 때 발생 |
| #REF! | 셀 참조가 유효하지 않거나 이상이 있는 경우 발생 |
| #VALUE! | 잘못된 인수나 피연산자를 사용했을 경우 발생 |

PROPER() → 문자열의 첫 문자만 대문자로 전환

- HLOOKUP()

![image](https://user-images.githubusercontent.com/70310271/225041358-ce4f9487-f75c-4a0a-9072-67dc961ce5c8.png)


- VLOOKUP()

![image](https://user-images.githubusercontent.com/70310271/225041498-66e55374-1d77-42ed-9389-9b442d4f44ae.png)

TRUE 또는 생략시 : 셀범위에 똑같은 값이 없을때, 찾을 값의 아래로 근사 값을 찾아준다.
이때, 셀 범위는 첫번째 행 또는 첫번째 열을 기준으로 오름차순 정렬되어 있어야한다.

FALSE : 정확한 값을 찾아주며, 정확한 값이 없을 떄는 #N/A 오류값을 반환한다.

- CHOOSE → switch문 닮음

=DCOUNT() → 레코드 필드 열에 수치데이터가 있는 셀의 개수를 계산함.

![image](https://user-images.githubusercontent.com/70310271/225041634-91c1fa51-109f-41b5-8829-c6b673570cc4.png)

- 기출

4,2,3,4,4,2,2,1,3,3

O,O,X,O,O,O,X,X,X,O

- 배운점

=SEARCHB(찾을값, 문자열)
SEARCHB는 바이너리로 찾는거라, 영문자는 1byte, 한글은 2byte로 친다. (발견되는곳은 1로 계산)

### 배열 계산식

- 배열 수식

Ctrl + Shift + Enter로 수식에 {}를 붙임

열은 쉼표, 행은 세미콜론으로 구분함.

=COUNT는 IF를 무조건 넣어야하고

=SUM은 IF를 안 넣어도되고 넣어도 된다.

[[컴활1급]배열수식은 이걸로 정리하세요](https://www.youtube.com/watch?v=ETAI_HFbmIc)

### 기본 데이터 관리

숨겨진 열이나 행은 정렬시 이동되지 않는다.

정렬기준 : 셀 색, 글꼴 색, 셀 아이콘 등

오름차순 : 숫자 > 문자 > 논리값 > 오류 값 > 빈셀 순

정렬 옵션에서 대/소문자 구분하게 체크할 수 있다.

정렬 옵션에서, 위아래 방향도 설정가능하다.

`기본 제공 사용자 지정 목록 수정 삭제 불가능. ->`저장시 컴퓨터 레지스트리에 저장

2개 이상의 열에 조건이 지정된 경우 AND조건으로 필터링되어 적용된다.

- 자동필터

필터링해서 복붙하면 제대로 복사안됨.

- 고급필터

자동필터와 다르게 복붙제대로됨.

고급 필터의 조건으로 수식의 계산이나 함수를 이용하여 지정할 수도 있다.

→ 단, 조건 입력시 첫 행에 입력할 필드명은 원본 필드명과 `같은 필드명을 사용할 수 없다.`

수식이나 함수를 이용하여 조건을 입력하면, TRUE 혹은 FALSE로 표시됨.

- 그룹

윤곽은 최대 8개 까지 만들수 있음.

- 상위10 자동필터

- 기출 문제

4,3,2,3,2,1,2,2

X,X,O,O,X,X,O,O

### 데이터 분석

- 데이터 표

데이터표의 기능을 사용하여 자동 입력된 데이터 값은 일부분만 수정하거나 삭제할 수 없다.

- 데이터 통합

통합 문서 내의 다른 워크시트뿐 아니라 다른 통합 문서에 있는 워크시트도 통합할 수 있다.

- 부분합

부분합을 작성하려면 첫 행에는 열 이름표가 있어야 하며, 데이터는 그룹화 할 항목을 기준으로 정렬되어 있어야한다.

부분합은 SUBTOTAL함수를 사용하여 합계나 평균등의 요약값을 계산한다.

여러개의 함수를 사용하여 중첩된 수준의 부분합을 작성할 수 있다.

- 시나리오

특정 셀의 변경에 따라 연결된 결과 셀의 `값이 자동으로 변경된다.`

여러 시나리오를 비교하기 위해 시나리오를 피벗 테이블로 요약가능

시나리오의 결과는 요약 보고서 또는 피벗 테이블 보고서로 만들 수 있다.

값이 서로 다른 그룹을 만들어 워크시트에 저장후 다른 결과를 얻기 위해 새로운 시나리오로 전환가능

시나리오 병합을 통하여 다른 통합 문서나 다른 워크시트에 저장된 시나리오를 가져올 수 있다.

시나리오의 결과는 요약 보고서나 피벗 테이블 보고서로 만들기 가능

변경 셀과 결과 셀에 이름을 지정한 후 시나리오 요약 보고서를 작성하면 결과에 셀 주소 대신 지정한 이름이 표시된다.

- 피벗테이블

피벗 테이블 보고서 작성 후 원본 데이터를 수정하면 수정된 내용이 피벗 테이블 보고서에 자동으로 반영 X → 새로고침을 해줘야함.

- 피벗 테이블 그룹화

자동으로 ‘그룹1, 그룹2, … ‘ 이름이 부여됨

숫자나 날짜 또는 시간 그룹화 : 시작, 끝 단위를 지정한다.

- 피벗 차트 보고서

피벗 차트 보고서는 피벗 테이블 보고서를 만들지 않고 서는 만들 수 없음

피벗 테이블과 피벗 차트를 함께 만들 후 피벗 테이블을 삭제하면 피벗 차트는 일반 차트로 변경됨.

피벗 차트 보고서를 삭제해도 관련 피벗 테이블 보고서는 삭제되지 않음.

피벗 차트 보고서 생성시 자동으로 항목, 범례 등이 삽입되어 표시됨 → 차트 제목은 생성안됨.

피벗 차트 보고서에 필터를 적용하면 피벗 테이블 보고서에 자동 적용됨.

- 기출

1,2,1,4,1,1,1,4,2,2,3

O,X,O,O,O,O,X,X,O,O,O

- 배운점

`부분합 작성시, 필드가 반드시 정렬되어 있어야한다.`

수식셀 → 바꾸고자 하는 부분(합계)

찾는값 → 목표값

값을 바꿀 셀 → 변수부분 (바꿔지는 부분)

![image](https://user-images.githubusercontent.com/70310271/225041721-753f19e6-984b-4e93-89a0-436e6aa380fc.png)

- 시나리오란 ?

시나리오 피벗 테이블 보고서에는 결과셀이 반드시 있어야함.

### 차트 작성

작성된 차트는 원본데이터가 변경되면 차트의 내용도 자동으로 함께 변경된다.

필요한 부분만 긁어서 Alt+F1 → 워크시트에 기본차트가 생성됨.

F11을 누르면 차트시트가 작성됨.

### 차트 작성

- 분산형 차트

3차원 차트로 작성불가

- 표현형 차트

표면형 차트는 항목과 데이터 계열이 모두 숫자 값인 경우에 사용가능.

- 콤보차트

3차원에서 혼합하여 사용 불가.

3차원 안됨

분산형,방사형,콤보차트

방분콤

Alt + F1 OR 그냥 F11이다.

- 기출

4,3,3,3,1,1,2,3,2,1,3

X,X,O,O,O,X,O,O,X,X,O

문제 답이 조금 이상함. 이 책은 개념만 빨리보고 넘기고 기출 풀자.

### 차트편집

계열 겹치기 0% → -100%~ 100% 사이값

요소 구분시 음수 → 데이터 구분 / 양수 → 데이터 겹침

간격 너비 150%. 0%~500%

### 매크로

이름은 반드시 문자로 시작해야 하며, “_”가 가능하다.

통합 문서를 열때마다 실행되도록 하려면 “Auto_Open”으로 매크로 이름을 정한다.

매크로 저장 위치인 XLSTART 폴더에 PERSONAL.XLSB로 저장하면 엑셀을 실행할 때 마다 모든 통합 문서에서 실행이 가능하다.

텍스트필드나, 콤보 상자에는 매크로를 연결 할 수 없음

## VBA

- 프로시저(Procedure)

프로시저란 모듈안에 작성하는 것으로 특정한 작업을 수행하는 일종의 명령문이다. 

일반적인 처리를 위한 Sub 프로시저 <Void형>

입력 값을 받아 특정한 작업을 수행한 후 결과를 반환시켜주는 Function 프로시저

사용자가 속성을 만들거나 저장하는 Property 프로시저

폼, 표준 모듈 ,클래스 모듈의 읽기 전용 속성을 만드는데 사용

코드에서 속성 값이 설정될 때 실행되어야 할 Public 변수 대신에 사용되어야 한다.

- 개체(Object)

통합문서, 셀, 시트, 차트, 파일, 폼 등이 이에 속한다.

- 속성(Property)

한 객체의 필드변수를 속성이라고 정의한다.

ActiveCell.Value = 1

Range(”E1”).Font.Size=12

- 메서드(Method)

Range(”E1”).Select

- 이벤트

파일을 열거나, 키보드, 마우스를 움직이는 등의 발생하는 어떤 조작을 말한다.

Private Sub Command1_Click()

- 컬렉션(Collection)

컬렉션이란 관련 개체 집단을 포함하는 개체를 의미한다. 

컬렉션 내에서 특정 개체의 위치는 변할 수 있다.

컬렉션은 보통 개체의 이름 마지막에 ‘s’를 붙여 사용한다.

모듈이 클래스이고 컬렉션은 라이브러리이다.

`VBA는 세미콜론 안찍는다.`

데이터 형식을 생략하면, Variant → 16byte로 설정됨.

데이터 형식은 따로 악미해야한다.

Boolean은 1비트가 아니라, 2Byte다.

Integer, 2Byte

Long 4 , Single(실수) 4

Double 8byte

Currency 8byte

Date 8byte

Object 4byte

배열은 최대 60차원까지 선언가능

정적 배열 → Dim Hi(5) As Integer

동적 배열 → Dim Hi() As Integer

`비쥬얼 베이직에는 Const가 존재하지 않는다.`

“Option Base 1”은 배열이 1부터 시작한다는 의미이다.
